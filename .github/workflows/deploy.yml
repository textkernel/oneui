name: Deploy
on:
  push:
    tags:
      - '[0-9]+.[0-9]+.[0-9]+'
  pull_request:
    types: [opened, reopened, synchronize, auto_merge_enabled]
    branches-ignore:
      - 'gh-pages'    
jobs:
    deploy:
        runs-on: ubuntu-latest
        steps:
            - uses: actions/checkout@v4
            - uses: ./.github/actions/npm-cache/
            - uses: actions/setup-node@v4
              with:
                node-version: 18
                cache: 'npm'
            - name: Install packages
              run: npm ci
            - name: Deploy storybook to Github Pages
              run: npm run storybook:deploy -- --ci
              env:
                  GH_TOKEN: Textkernel:${{ secrets.GITHUB_TOKEN }}
